resize_images:
  cmd: python pipe/resize_images.py
  deps:
  - path: pipe/resize_images.py
    md5: b39474c935b21002222e8a712ebe27f6
  - path: data/train
    md5: 9591f3b1fe39ddb679aadfd5ec9c6b3c.dir
  - path: data/test
    md5: 5d1a75a42c39a65cf84664d5d0e0f0b4.dir
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  outs:
  - path: data/train_128
    md5: d04c4c8ef47b1f81a5f8db5ca48cc536.dir
  - path: data/test_128
    md5: 5364e325677bd83100a46caa1bf54bc5.dir
  - path: data/train_192
    md5: 185af62b35d2914cf205b7a9094976aa.dir
  - path: data/test_192
    md5: 77becdfc19b4a7082b6f92cacce2570e.dir
  - path: data/train_256
    md5: 1956b28f215b75b89ede91d864196e38.dir
  - path: data/test_256
    md5: 112e0a5ed8c9d17787032dbaab97a758.dir
  - path: data/train_384
    md5: 5c1bf1e09e9d69afc1d1d678169b1c61.dir
  - path: data/test_384
    md5: bf00d2deb0e134d787d22959f9e8a7f6.dir
  - path: data/train_512
    md5: dad0ba42319fddc5c335f179b0f528a3.dir
  - path: data/test_512
    md5: 487534745b2d764c41f5ad58f26922c4.dir
  - path: data/train_768
    md5: 07e6ef9a92ae9e2df9cc187931b0d311.dir
  - path: data/test_768
    md5: 2fdd5ecaf2c08bc67b20a68e14c05020.dir
  - path: data/train_1024
    md5: 5b842bb1de75e27929a69aeb982dfe22.dir
  - path: data/test_1024
    md5: 4ba60228e7d9a0c4df6f909e4d6ac916.dir
dupes:
  cmd: wget -O data/dupes.csv https://storage.googleapis.com/kaggle-forum-message-attachments/903372/16145/2020_Challenge_duplicates.csv
  outs:
  - path: data/dupes.csv
    md5: d66be798291024f1fd9811e5836bc7d7
download_train_extra_128:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-128x128
  outs:
  - path: malignant-v2-128x128.zip
    md5: bb4f4cb68a16ba92f6ac21a23d89da90
download_train_extra_192:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-192x192
  outs:
  - path: malignant-v2-192x192.zip
    md5: 6c09ba79a90155fc733a66a63aa0edd7
download_train_extra_256:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-256x256
  outs:
  - path: malignant-v2-256x256.zip
    md5: a0b205e6ab2b8cc6b95e5e67ebdf4439
download_train_extra_384:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-384x384
  outs:
  - path: malignant-v2-384x384.zip
    md5: 2844989ad0d76af5884df4584c28c9d5
download_train_extra_512:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-512x512
  outs:
  - path: malignant-v2-512x512.zip
    md5: 83d28d848567826a457eec08f915e65b
split:
  cmd: python pipe/split.py
  deps:
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: pipe/split.py
    md5: 55241e33181b836bf629f4868fc8e6d0
  outs:
  - path: data/folds.csv
    md5: dd7dfbbd2660d671499a2b8066c34de8
train_lr:
  cmd: python pipe/train_lr.py
  deps:
  - path: data/x_train_32.npy
    md5: 73757c03eedb9cec603984370d2c368a
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: pipe/train_lr.py
    md5: d8e7140ae8a78cd9608dfffbeb4e32c8
  outs:
  - path: models/stage1_lr.joblib
    md5: 8024fe234ad16b0c928cd7ed9b9fc092
  - path: metrics/cv.metric
    md5: 11fd4b3e77e6dc35db91f3fad7a96bc5
train_efficientnet_384:
  cmd: python pipe/train_efficientnet_384.py
  deps:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_384
    md5: bf00d2deb0e134d787d22959f9e8a7f6.dir
  - path: data/train_384
    md5: 5c1bf1e09e9d69afc1d1d678169b1c61.dir
  - path: data/train_with_extra_384
    md5: e72675d7490d03e5deb30d3e3f7fe1ac.dir
  - path: pipe/train_efficientnet_384.py
    md5: 9809b6d5498d8483328cfb546506243b
  params:
    params.yaml:
      train_efficientnet_384:
        epochs: 15
        arch: efficientnet-b4
        precision: 16
        sz: 384
        bs: 16
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/l1_efficientnet_384_oof_preds.csv
    md5: 193db64d238627d341d9f47236a53ec8
  - path: metrics/l1_efficientnet_384_cv.metric
    md5: 4a5642653b5f7104dccc27fe8277d3b4
  - path: models/model_name=efficientnet_sz=384_fold=0.ckpt
    md5: 8eba401321c879675b0052e491466004
  - path: models/model_name=efficientnet_sz=384_fold=1.ckpt
    md5: df54bd16fe1a5ff105105f24eca5328f
  - path: models/model_name=efficientnet_sz=384_fold=2.ckpt
    md5: cc8e1ccfd7f9aa2037786a82471d1f06
  - path: models/model_name=efficientnet_sz=384_fold=3.ckpt
    md5: 0c1887338b277a9a98571f127df5a5d9
  - path: models/model_name=efficientnet_sz=384_fold=4.ckpt
    md5: 5b8bdae6cdcb5ba48853b4a3a5ba44bc
  - path: subs/l1_efficientnet_384_submission.csv
    md5: 2ddfb3a55d82ddc0b441334ff3fde6a6
  - path: subs/subs_efficientnet_384_fold0.csv
    md5: 9566945fe7f198806c20ec369570c9b0
  - path: subs/subs_efficientnet_384_fold1.csv
    md5: c47a7fed8a3fc99ca23cceb93b00b5d7
  - path: subs/subs_efficientnet_384_fold2.csv
    md5: d05755f2aa7857c189b944089aae9b73
  - path: subs/subs_efficientnet_384_fold3.csv
    md5: c00554e328e8a1a1040bbfbd5399a3b2
  - path: subs/subs_efficientnet_384_fold4.csv
    md5: 08d3829063da9634b41e40d56fe72492
train_resnet_128:
  cmd: python pipe/train_resnet_128.py
  deps:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_128
    md5: 5364e325677bd83100a46caa1bf54bc5.dir
  - path: data/train_128
    md5: d04c4c8ef47b1f81a5f8db5ca48cc536.dir
  - path: data/train_with_extra_128
    md5: 15cdc0e17ae05d1c1a810f551c207ed2.dir
  - path: pipe/train_resnet_128.py
    md5: 72a60f1e99b40c955af4676b8823cdda
  params:
    params.yaml:
      train_resnet_128:
        epochs: 20
        arch: resnet34
        precision: 16
        sz: 128
        bs: 512
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/l1_resnet_128_oof_preds.csv
    md5: 03fa4707b03579843f69bdd1180a6e3d
  - path: metrics/l1_resnet_128_cv.metric
    md5: bfed817992af38d0a56418036ff05b69
  - path: models/model_name=resnet_sz=128_fold=0.ckpt
    md5: d205ae2392c9e65319cf7d7a74c1f7ff
  - path: models/model_name=resnet_sz=128_fold=1.ckpt
    md5: caa8dcb6a7b1749a6e9d71620de5d910
  - path: models/model_name=resnet_sz=128_fold=2.ckpt
    md5: 3eeb5f9a8e9f5ad47609af504ac76f74
  - path: models/model_name=resnet_sz=128_fold=3.ckpt
    md5: 01f22f52d8d3adea7001964fa958e538
  - path: models/model_name=resnet_sz=128_fold=4.ckpt
    md5: 9131fe4863560f8a545729184b42adad
  - path: subs/l1_resnet_128_submission.csv
    md5: 03735c33a9127aa63deb00679d7fa468
  - path: subs/subs_resnet_128_fold0.csv
    md5: 80185d23760d2dd7088135fe55cbd966
  - path: subs/subs_resnet_128_fold1.csv
    md5: 344f028a7781adf4bd45f4197123390f
  - path: subs/subs_resnet_128_fold2.csv
    md5: bfdcca6a2e8138e7c3061c00d76ea424
  - path: subs/subs_resnet_128_fold3.csv
    md5: ba1fbf913b1d469d6edec58f6654e1ae
  - path: subs/subs_resnet_128_fold4.csv
    md5: c2f71ce03157d9a63e3d379aa6f05d3d
unzip_extra_malig_data:
  cmd: python pipe/add_extra_malig.py
  deps:
  - path: data/train_128
    md5: d04c4c8ef47b1f81a5f8db5ca48cc536.dir
  - path: data/train_192
    md5: 185af62b35d2914cf205b7a9094976aa.dir
  - path: data/train_256
    md5: 1956b28f215b75b89ede91d864196e38.dir
  - path: data/train_384
    md5: 5c1bf1e09e9d69afc1d1d678169b1c61.dir
  - path: data/train_512
    md5: dad0ba42319fddc5c335f179b0f528a3.dir
  - path: jpeg-isic2019-128x128.zip
    md5: 80ab82c9dc92968100e1dcc0b0379c65
  - path: jpeg-isic2019-192x192.zip
    md5: 4a3ca6be2e07ddbbb3807ccbdaadce32
  - path: jpeg-isic2019-256x256.zip
    md5: 82cb01de93e3d15737f627bfeae34de8
  - path: jpeg-isic2019-384x384.zip
    md5: 29341d9020e86c63de6ee749257fa744
  - path: jpeg-isic2019-512x512.zip
    md5: c9628a89b50b5b9965bec6cb656f562c
  - path: malignant-v2-128x128.zip
    md5: bb4f4cb68a16ba92f6ac21a23d89da90
  - path: malignant-v2-192x192.zip
    md5: 6c09ba79a90155fc733a66a63aa0edd7
  - path: malignant-v2-256x256.zip
    md5: a0b205e6ab2b8cc6b95e5e67ebdf4439
  - path: malignant-v2-384x384.zip
    md5: 2844989ad0d76af5884df4584c28c9d5
  - path: malignant-v2-512x512.zip
    md5: 83d28d848567826a457eec08f915e65b
  - path: pipe/add_extra_malig.py
    md5: 972eb9d11898ead919e29eca77fbb7c2
  outs:
  - path: data/train_malig_1.csv
    md5: c8a7c03244fe75129ff7a603b5537ee6
  - path: data/train_malig_2.csv
    md5: d57b6ac5b82f6715da35cca79dad5145
  - path: data/train_malig_3.csv
    md5: 5736b06c158b6fdbbb57664a37e1868f
  - path: data/train_with_extra_128
    md5: 15cdc0e17ae05d1c1a810f551c207ed2.dir
  - path: data/train_with_extra_192
    md5: 19748128fa7e2a518e7b1e5d0edee43e.dir
  - path: data/train_with_extra_256
    md5: 2cdd4693c24ca870f6a1b25bf6aa3c60.dir
  - path: data/train_with_extra_384
    md5: e72675d7490d03e5deb30d3e3f7fe1ac.dir
  - path: data/train_with_extra_512
    md5: b490cd755354d577da430f44f9e20918.dir
split_with_extra:
  cmd: python pipe/split_with_extra.py
  deps:
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: data/train_malig_1.csv
    md5: c8a7c03244fe75129ff7a603b5537ee6
  - path: data/train_malig_2.csv
    md5: d57b6ac5b82f6715da35cca79dad5145
  - path: data/train_malig_3.csv
    md5: 5736b06c158b6fdbbb57664a37e1868f
  - path: pipe/split_with_extra.py
    md5: c10f8b12b02c5f4b8f00cae48add5f69
  outs:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
download_train_2019_128:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-128x128
  outs:
  - path: jpeg-isic2019-128x128.zip
    md5: 80ab82c9dc92968100e1dcc0b0379c65
download_train_2019_192:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-192x192
  outs:
  - path: jpeg-isic2019-192x192.zip
    md5: 4a3ca6be2e07ddbbb3807ccbdaadce32
download_train_2019_384:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-384x384
  outs:
  - path: jpeg-isic2019-384x384.zip
    md5: 29341d9020e86c63de6ee749257fa744
download_train_2019_256:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-256x256
  outs:
  - path: jpeg-isic2019-256x256.zip
    md5: 82cb01de93e3d15737f627bfeae34de8
download_train_2019_512:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-512x512
  outs:
  - path: jpeg-isic2019-512x512.zip
    md5: c9628a89b50b5b9965bec6cb656f562c
download_hair:
  cmd: kaggle datasets download -d nroman/melanoma-hairs
  outs:
  - path: melanoma-hairs.zip
    md5: 172bbcd5f757e9778438bcd1d0a6f6db
unzip_hairs:
  cmd: unzip melanoma-hairs.zip -d data/hairs/
  deps:
  - path: melanoma-hairs.zip
    md5: 172bbcd5f757e9778438bcd1d0a6f6db
  outs:
  - path: data/hairs/
    md5: 2ac962347692c92174c953347ca50939.dir
train_resnet_256:
  cmd: python pipe/train_resnet_256.py
  deps:
  - path: data/folds_with_extra.csv
    md5: e41059d293157cbeb014fd991083f1f4
  - path: data/hairs
    md5: 2ac962347692c92174c953347ca50939.dir
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_256
    md5: 112e0a5ed8c9d17787032dbaab97a758.dir
  - path: data/train_with_extra_256
    md5: 2cdd4693c24ca870f6a1b25bf6aa3c60.dir
  - path: pipe/train_resnet_256.py
    md5: ec5cad414f29fbb3607f5f27b4ddfc6d
  params:
    params.yaml:
      train_resnet_256:
        epochs: 10
        arch: resnet34
        precision: 16
        sz: 256
        bs: 256
        lr: 0.001
        wd: 0.01
        mom: 0.9
  outs:
  - path: metrics/l1_resnet_256_cv.metric
    md5: 86fd48a34e9ca33a40f806e01499da76
  - path: subs/l1_resnet_256_submission.csv
    md5: 50a91d6a3f504b182eaa1a2b9a820392
  - path: subs/subs_resnet_256_fold0.csv
    md5: 51f1cae94c7b9caaa7dfff95bd58607a
  - path: subs/subs_resnet_256_fold1.csv
    md5: 4317647ff2f0833839ac1ddd29b707f3
  - path: subs/subs_resnet_256_fold2.csv
    md5: 1405a3561d2d30fac3cd3e8df8eb1d03
  - path: subs/subs_resnet_256_fold3.csv
    md5: aba1c745897be689f11dfeeeec6b6759
  - path: subs/subs_resnet_256_fold4.csv
    md5: 376132713714dd4642b61e971412dd87
train_efficientnet_256:
  cmd: python pipe/train_efficientnet_256.py
  deps:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_256
    md5: 112e0a5ed8c9d17787032dbaab97a758.dir
  - path: data/train_256
    md5: 1956b28f215b75b89ede91d864196e38.dir
  - path: data/train_with_extra_256
    md5: 2cdd4693c24ca870f6a1b25bf6aa3c60.dir
  - path: pipe/train_efficientnet_256.py
    md5: b102a8c9764fa528b414768c34eb83dc
  params:
    params.yaml:
      train_efficientnet_256:
        epochs: 20
        arch: efficientnet-b4
        precision: 16
        sz: 256
        bs: 32
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/l1_efficientnet_256_oof_preds.csv
    md5: aeef0a6942cc378a3da8ea1db5329664
  - path: metrics/l1_efficientnet_256_cv.metric
    md5: 6af97f9b362780155223a5f4076282ca
  - path: models/model_name=efficientnet_sz=256_fold=0.ckpt
    md5: 485e0344b87973dd1f256d6f911acc21
  - path: models/model_name=efficientnet_sz=256_fold=1.ckpt
    md5: 9a8537d53b82ec4217e7d551069264de
  - path: models/model_name=efficientnet_sz=256_fold=2.ckpt
    md5: 079d319d68d119c896f3725b75513277
  - path: models/model_name=efficientnet_sz=256_fold=3.ckpt
    md5: 465aa53c670a8b08260dbade58282fb5
  - path: models/model_name=efficientnet_sz=256_fold=4.ckpt
    md5: b9da2e427f2e797d45a088938fa8caef
  - path: subs/l1_efficientnet_256_submission.csv
    md5: 3772c7e4b501cc26a584bf241c7d30df
  - path: subs/subs_efficientnet_256_fold0.csv
    md5: 855a1cd122963b72bb2b5f5a402a504e
  - path: subs/subs_efficientnet_256_fold1.csv
    md5: 962343f77271657ec45c2785ff18ef8e
  - path: subs/subs_efficientnet_256_fold2.csv
    md5: f883e82cd8511a40d44791b36c43d92c
  - path: subs/subs_efficientnet_256_fold3.csv
    md5: 8d356986b8a7e037a2df07849a4e3763
  - path: subs/subs_efficientnet_256_fold4.csv
    md5: c197ef9d73fe798355b862be1983170c
