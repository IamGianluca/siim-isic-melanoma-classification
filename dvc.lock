resize_images:
  cmd: python pipe/resize_images.py
  deps:
  - path: pipe/resize_images.py
    md5: b39474c935b21002222e8a712ebe27f6
  - path: data/train
    md5: 9591f3b1fe39ddb679aadfd5ec9c6b3c.dir
  - path: data/test
    md5: 5d1a75a42c39a65cf84664d5d0e0f0b4.dir
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  outs:
  - path: data/train_128
    md5: d04c4c8ef47b1f81a5f8db5ca48cc536.dir
  - path: data/test_128
    md5: 5364e325677bd83100a46caa1bf54bc5.dir
  - path: data/train_192
    md5: 185af62b35d2914cf205b7a9094976aa.dir
  - path: data/test_192
    md5: 77becdfc19b4a7082b6f92cacce2570e.dir
  - path: data/train_256
    md5: 1956b28f215b75b89ede91d864196e38.dir
  - path: data/test_256
    md5: 112e0a5ed8c9d17787032dbaab97a758.dir
  - path: data/train_384
    md5: 5c1bf1e09e9d69afc1d1d678169b1c61.dir
  - path: data/test_384
    md5: bf00d2deb0e134d787d22959f9e8a7f6.dir
  - path: data/train_512
    md5: dad0ba42319fddc5c335f179b0f528a3.dir
  - path: data/test_512
    md5: 487534745b2d764c41f5ad58f26922c4.dir
  - path: data/train_768
    md5: 07e6ef9a92ae9e2df9cc187931b0d311.dir
  - path: data/test_768
    md5: 2fdd5ecaf2c08bc67b20a68e14c05020.dir
  - path: data/train_1024
    md5: 5b842bb1de75e27929a69aeb982dfe22.dir
  - path: data/test_1024
    md5: 4ba60228e7d9a0c4df6f909e4d6ac916.dir
dupes:
  cmd: wget -O data/dupes.csv https://storage.googleapis.com/kaggle-forum-message-attachments/903372/16145/2020_Challenge_duplicates.csv
  outs:
  - path: data/dupes.csv
    md5: d66be798291024f1fd9811e5836bc7d7
download_train_extra_128:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-128x128
  outs:
  - path: malignant-v2-128x128.zip
    md5: bb4f4cb68a16ba92f6ac21a23d89da90
download_train_extra_192:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-192x192
  outs:
  - path: malignant-v2-192x192.zip
    md5: 6c09ba79a90155fc733a66a63aa0edd7
download_train_extra_256:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-256x256
  outs:
  - path: malignant-v2-256x256.zip
    md5: a0b205e6ab2b8cc6b95e5e67ebdf4439
download_train_extra_384:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-384x384
  outs:
  - path: malignant-v2-384x384.zip
    md5: 2844989ad0d76af5884df4584c28c9d5
download_train_extra_512:
  cmd: kaggle datasets download -d cdeotte/malignant-v2-512x512
  outs:
  - path: malignant-v2-512x512.zip
    md5: 83d28d848567826a457eec08f915e65b
split:
  cmd: python pipe/split.py
  deps:
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: pipe/split.py
    md5: 55241e33181b836bf629f4868fc8e6d0
  outs:
  - path: data/folds.csv
    md5: dd7dfbbd2660d671499a2b8066c34de8
train_efficientnet_384:
  cmd: python pipe/train_efficientnet_384.py
  deps:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_384
    md5: bf00d2deb0e134d787d22959f9e8a7f6.dir
  - path: data/train_384
    md5: 5c1bf1e09e9d69afc1d1d678169b1c61.dir
  - path: data/train_with_extra_384
    md5: e72675d7490d03e5deb30d3e3f7fe1ac.dir
  - path: pipe/train_efficientnet_384.py
    md5: cdec1cd1f62a15c76e4e98d5c60c3706
  params:
    params.yaml:
      train_efficientnet_384:
        epochs: 15
        arch: efficientnet-b4
        precision: 16
        sz: 384
        bs: 16
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/l1_efficientnet_384_oof_preds.csv
    md5: d3272f5d45c520d098b1ed469e0dec05
  - path: metrics/l1_efficientnet_384_cv.metric
    md5: bb4df0fd08f12830849da97c5da42114
  - path: models/model_name=efficientnet_sz=384_fold=0.ckpt
    md5: 5b9c29b841f87b1658ab97c50e0e9c62
  - path: models/model_name=efficientnet_sz=384_fold=1.ckpt
    md5: 8bd268bdfc5b3c3d01149050472de61d
  - path: models/model_name=efficientnet_sz=384_fold=2.ckpt
    md5: bf31c46ba622fe380bb267fc9457e61a
  - path: models/model_name=efficientnet_sz=384_fold=3.ckpt
    md5: 8ab3256cea0017876d7b11908adc7b0a
  - path: models/model_name=efficientnet_sz=384_fold=4.ckpt
    md5: 23f1fc4e631358017dfe7ba212ef1693
  - path: subs/l1_efficientnet_384_submission.csv
    md5: 3bb53d752c468e1de469f9de9141d7f9
  - path: subs/subs_efficientnet_384_fold0.csv
    md5: 3c73f12d4e9f8d23dae5fd29d9636211
  - path: subs/subs_efficientnet_384_fold1.csv
    md5: 7d02af7e68df867d5966cc8e33956ceb
  - path: subs/subs_efficientnet_384_fold2.csv
    md5: 155297921947bd717c28d4759804bed6
  - path: subs/subs_efficientnet_384_fold3.csv
    md5: 1b4705be4f55319e595ff2b4701ac786
  - path: subs/subs_efficientnet_384_fold4.csv
    md5: 11404d5d3cf6fbfdb637565062e0f920
train_resnet_128:
  cmd: python pipe/train_resnet_128.py
  deps:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_128
    md5: 5364e325677bd83100a46caa1bf54bc5.dir
  - path: data/train_128
    md5: d04c4c8ef47b1f81a5f8db5ca48cc536.dir
  - path: data/train_with_extra_128
    md5: 15cdc0e17ae05d1c1a810f551c207ed2.dir
  - path: pipe/train_resnet_128.py
    md5: c5a072e25028df808f2a6acd54551139
  params:
    params.yaml:
      train_resnet_128:
        epochs: 20
        arch: resnet34
        precision: 16
        sz: 128
        bs: 512
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/l1_resnet_128_oof_preds.csv
    md5: 03fa4707b03579843f69bdd1180a6e3d
  - path: metrics/l1_resnet_128_cv.metric
    md5: bfed817992af38d0a56418036ff05b69
  - path: models/model_name=resnet_sz=128_fold=0.ckpt
    md5: d205ae2392c9e65319cf7d7a74c1f7ff
  - path: models/model_name=resnet_sz=128_fold=1.ckpt
    md5: caa8dcb6a7b1749a6e9d71620de5d910
  - path: models/model_name=resnet_sz=128_fold=2.ckpt
    md5: 3eeb5f9a8e9f5ad47609af504ac76f74
  - path: models/model_name=resnet_sz=128_fold=3.ckpt
    md5: 01f22f52d8d3adea7001964fa958e538
  - path: models/model_name=resnet_sz=128_fold=4.ckpt
    md5: 9131fe4863560f8a545729184b42adad
  - path: subs/l1_resnet_128_submission.csv
    md5: 03735c33a9127aa63deb00679d7fa468
  - path: subs/subs_resnet_128_fold0.csv
    md5: 80185d23760d2dd7088135fe55cbd966
  - path: subs/subs_resnet_128_fold1.csv
    md5: 344f028a7781adf4bd45f4197123390f
  - path: subs/subs_resnet_128_fold2.csv
    md5: bfdcca6a2e8138e7c3061c00d76ea424
  - path: subs/subs_resnet_128_fold3.csv
    md5: ba1fbf913b1d469d6edec58f6654e1ae
  - path: subs/subs_resnet_128_fold4.csv
    md5: c2f71ce03157d9a63e3d379aa6f05d3d
unzip_extra_malig_data:
  cmd: python pipe/add_extra_malig.py
  deps:
  - path: data/train_128
    md5: d04c4c8ef47b1f81a5f8db5ca48cc536.dir
  - path: data/train_192
    md5: 185af62b35d2914cf205b7a9094976aa.dir
  - path: data/train_256
    md5: 1956b28f215b75b89ede91d864196e38.dir
  - path: data/train_384
    md5: 5c1bf1e09e9d69afc1d1d678169b1c61.dir
  - path: data/train_512
    md5: dad0ba42319fddc5c335f179b0f528a3.dir
  - path: jpeg-isic2019-128x128.zip
    md5: 80ab82c9dc92968100e1dcc0b0379c65
  - path: jpeg-isic2019-192x192.zip
    md5: 4a3ca6be2e07ddbbb3807ccbdaadce32
  - path: jpeg-isic2019-256x256.zip
    md5: 82cb01de93e3d15737f627bfeae34de8
  - path: jpeg-isic2019-384x384.zip
    md5: 29341d9020e86c63de6ee749257fa744
  - path: jpeg-isic2019-512x512.zip
    md5: c9628a89b50b5b9965bec6cb656f562c
  - path: malignant-v2-128x128.zip
    md5: bb4f4cb68a16ba92f6ac21a23d89da90
  - path: malignant-v2-192x192.zip
    md5: 6c09ba79a90155fc733a66a63aa0edd7
  - path: malignant-v2-256x256.zip
    md5: a0b205e6ab2b8cc6b95e5e67ebdf4439
  - path: malignant-v2-384x384.zip
    md5: 2844989ad0d76af5884df4584c28c9d5
  - path: malignant-v2-512x512.zip
    md5: 83d28d848567826a457eec08f915e65b
  - path: pipe/add_extra_malig.py
    md5: 972eb9d11898ead919e29eca77fbb7c2
  outs:
  - path: data/train_malig_1.csv
    md5: c8a7c03244fe75129ff7a603b5537ee6
  - path: data/train_malig_2.csv
    md5: d57b6ac5b82f6715da35cca79dad5145
  - path: data/train_malig_3.csv
    md5: 5736b06c158b6fdbbb57664a37e1868f
  - path: data/train_with_extra_128
    md5: 15cdc0e17ae05d1c1a810f551c207ed2.dir
  - path: data/train_with_extra_192
    md5: 19748128fa7e2a518e7b1e5d0edee43e.dir
  - path: data/train_with_extra_256
    md5: 2cdd4693c24ca870f6a1b25bf6aa3c60.dir
  - path: data/train_with_extra_384
    md5: e72675d7490d03e5deb30d3e3f7fe1ac.dir
  - path: data/train_with_extra_512
    md5: b490cd755354d577da430f44f9e20918.dir
split_with_extra:
  cmd: python pipe/split_with_extra.py
  deps:
  - path: data/train.csv
    md5: 86657c7009b003543b377b62a8745b4c
  - path: data/train_malig_1.csv
    md5: c8a7c03244fe75129ff7a603b5537ee6
  - path: data/train_malig_2.csv
    md5: d57b6ac5b82f6715da35cca79dad5145
  - path: data/train_malig_3.csv
    md5: 5736b06c158b6fdbbb57664a37e1868f
  - path: pipe/split_with_extra.py
    md5: c10f8b12b02c5f4b8f00cae48add5f69
  outs:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
download_train_2019_128:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-128x128
  outs:
  - path: jpeg-isic2019-128x128.zip
    md5: 80ab82c9dc92968100e1dcc0b0379c65
download_train_2019_192:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-192x192
  outs:
  - path: jpeg-isic2019-192x192.zip
    md5: 4a3ca6be2e07ddbbb3807ccbdaadce32
download_train_2019_384:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-384x384
  outs:
  - path: jpeg-isic2019-384x384.zip
    md5: 29341d9020e86c63de6ee749257fa744
download_train_2019_256:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-256x256
  outs:
  - path: jpeg-isic2019-256x256.zip
    md5: 82cb01de93e3d15737f627bfeae34de8
download_train_2019_512:
  cmd: kaggle datasets download -d cdeotte/jpeg-isic2019-512x512
  outs:
  - path: jpeg-isic2019-512x512.zip
    md5: c9628a89b50b5b9965bec6cb656f562c
unzip_hairs:
  cmd: unzip melanoma-hairs.zip -d data/hairs/
  deps:
  - path: melanoma-hairs.zip
    md5: 172bbcd5f757e9778438bcd1d0a6f6db
  outs:
  - path: data/hairs/
    md5: 2ac962347692c92174c953347ca50939.dir
train_efficientnet_256:
  cmd: python pipe/train_efficientnet_256.py
  deps:
  - path: data/folds_with_extra.csv
    md5: dd2832bd37791f544e7471f50d0a8ee1
  - path: data/test.csv
    md5: 90a1a5b724eb0cf2666fbd850d6f55b1
  - path: data/test_256
    md5: 112e0a5ed8c9d17787032dbaab97a758.dir
  - path: data/train_256
    md5: 1956b28f215b75b89ede91d864196e38.dir
  - path: data/train_with_extra_256
    md5: 2cdd4693c24ca870f6a1b25bf6aa3c60.dir
  - path: pipe/train_efficientnet_256.py
    md5: b102a8c9764fa528b414768c34eb83dc
  params:
    params.yaml:
      train_efficientnet_256:
        epochs: 20
        arch: efficientnet-b4
        precision: 16
        sz: 256
        bs: 32
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/l1_efficientnet_256_oof_preds.csv
    md5: aeef0a6942cc378a3da8ea1db5329664
  - path: metrics/l1_efficientnet_256_cv.metric
    md5: 6af97f9b362780155223a5f4076282ca
  - path: models/model_name=efficientnet_sz=256_fold=0.ckpt
    md5: 485e0344b87973dd1f256d6f911acc21
  - path: models/model_name=efficientnet_sz=256_fold=1.ckpt
    md5: 9a8537d53b82ec4217e7d551069264de
  - path: models/model_name=efficientnet_sz=256_fold=2.ckpt
    md5: 079d319d68d119c896f3725b75513277
  - path: models/model_name=efficientnet_sz=256_fold=3.ckpt
    md5: 465aa53c670a8b08260dbade58282fb5
  - path: models/model_name=efficientnet_sz=256_fold=4.ckpt
    md5: b9da2e427f2e797d45a088938fa8caef
  - path: subs/l1_efficientnet_256_submission.csv
    md5: 3772c7e4b501cc26a584bf241c7d30df
  - path: subs/subs_efficientnet_256_fold0.csv
    md5: 855a1cd122963b72bb2b5f5a402a504e
  - path: subs/subs_efficientnet_256_fold1.csv
    md5: 962343f77271657ec45c2785ff18ef8e
  - path: subs/subs_efficientnet_256_fold2.csv
    md5: f883e82cd8511a40d44791b36c43d92c
  - path: subs/subs_efficientnet_256_fold3.csv
    md5: 8d356986b8a7e037a2df07849a4e3763
  - path: subs/subs_efficientnet_256_fold4.csv
    md5: c197ef9d73fe798355b862be1983170c
predict_resnet_128:
  cmd: python pipe/predict_resnet_128.py
  deps:
  - path: models/model_name=resnet_sz=128_fold=0.ckpt
    md5: d205ae2392c9e65319cf7d7a74c1f7ff
  - path: models/model_name=resnet_sz=128_fold=1.ckpt
    md5: caa8dcb6a7b1749a6e9d71620de5d910
  - path: models/model_name=resnet_sz=128_fold=2.ckpt
    md5: 3eeb5f9a8e9f5ad47609af504ac76f74
  - path: models/model_name=resnet_sz=128_fold=3.ckpt
    md5: 01f22f52d8d3adea7001964fa958e538
  - path: models/model_name=resnet_sz=128_fold=4.ckpt
    md5: 9131fe4863560f8a545729184b42adad
  - path: pipe/predict_resnet_128.py
    md5: 56f945f1a77396c8cf0b469982b7c1de
  params:
    params.yaml:
      train_resnet_128:
        epochs: 20
        arch: resnet34
        precision: 16
        sz: 128
        bs: 512
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/oof_preds_resnet_tta_128.csv
    md5: a0b6933b2bd7a6cbb95d65ff37aeb72b
  - path: metrics/l1_resnet_tta_128_cv.metric
    md5: baec01116f70d76e7f12b880a6868e39
  - path: subs/l1_resnet_tta_128_submission.csv
    md5: 484b2fa908d1e9cb59757b58bf5162ef
predict_efficientnet_384:
  cmd: python pipe/predict_efficientnet_384.py
  deps:
  - path: models/model_name=efficientnet_sz=384_fold=0.ckpt
    md5: 5b9c29b841f87b1658ab97c50e0e9c62
  - path: models/model_name=efficientnet_sz=384_fold=1.ckpt
    md5: 8bd268bdfc5b3c3d01149050472de61d
  - path: models/model_name=efficientnet_sz=384_fold=2.ckpt
    md5: bf31c46ba622fe380bb267fc9457e61a
  - path: models/model_name=efficientnet_sz=384_fold=3.ckpt
    md5: 8ab3256cea0017876d7b11908adc7b0a
  - path: models/model_name=efficientnet_sz=384_fold=4.ckpt
    md5: 23f1fc4e631358017dfe7ba212ef1693
  - path: pipe/predict_efficientnet_384.py
    md5: 845726b688f65df88fc9c2a3acb899ce
  params:
    params.yaml:
      train_efficientnet_384:
        epochs: 15
        arch: efficientnet-b4
        precision: 16
        sz: 384
        bs: 16
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/oof_preds_efficientnet_tta_384.csv
    md5: 8ee5b657be86ef0a8813d3398eec6e66
  - path: metrics/l1_efficientnet_tta_384_cv.metric
    md5: bd59690f64517e92d1a56c3bc696a52f
  - path: subs/l1_efficientnet_tta_384_submission.csv
    md5: 1259abfa5bd82f6bd3744bf53e0bd5ba
predict_efficientnet_256:
  cmd: python pipe/predict_efficientnet_256.py
  deps:
  - path: models/model_name=efficientnet_sz=256_fold=0.ckpt
    md5: 485e0344b87973dd1f256d6f911acc21
  - path: models/model_name=efficientnet_sz=256_fold=1.ckpt
    md5: 9a8537d53b82ec4217e7d551069264de
  - path: models/model_name=efficientnet_sz=256_fold=2.ckpt
    md5: 079d319d68d119c896f3725b75513277
  - path: models/model_name=efficientnet_sz=256_fold=3.ckpt
    md5: 465aa53c670a8b08260dbade58282fb5
  - path: models/model_name=efficientnet_sz=256_fold=4.ckpt
    md5: b9da2e427f2e797d45a088938fa8caef
  - path: pipe/predict_efficientnet_256.py
    md5: c4870e3c03e5e7d190122d74a29ceea7
  params:
    params.yaml:
      train_efficientnet_256:
        epochs: 20
        arch: efficientnet-b4
        precision: 16
        sz: 256
        bs: 32
        lr: find
        wd: 0.01
        mom: 0.9
  outs:
  - path: data/oof_preds_efficientnet_tta_256.csv
    md5: 854616cbc8c9e8803c201467bdc32a9d
  - path: metrics/l1_efficientnet_tta_256_cv.metric
    md5: ca7ea19513f62d3210453274448ecb23
  - path: subs/l1_efficientnet_tta_256_submission.csv
    md5: 343c92d2f4bc9fb8cd5eb20f6df1fc6e
